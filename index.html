<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Документация проекта</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js"></script>
</head>
<body>
<div class="container">
    <!-- Сайдбар с документацией -->
    <aside class="sidebar">
        <div class="sidebar-header">
            <h2><i class="fas fa-book"></i> Документация</h2>
            <button id="toggleSidebar" class="toggle-btn" title="Скрыть панель">
                <i class="fas fa-chevron-left"></i>
            </button>
        </div>

        <nav class="sidebar-nav">
            <ul>
                <!-- Введение -->
                <li class="nav-item active" data-content="introduction">
                    <i class="fas fa-home icon"></i>
                    <span class="text">Введение</span>
                </li>

                <!-- Команда -->
                <li class="nav-item" data-content="team">
                    <i class="fas fa-users icon"></i>
                    <span class="text">Команда</span>
                </li>

                <!-- Задание -->
                <li class="nav-item" data-content="task">
                    <i class="fas fa-tasks icon"></i>
                    <span class="text">Задание</span>
                </li>

                <!-- Глоссарий -->
                <li class="nav-item" data-content="glossary">
                    <i class="fas fa-book-open icon"></i>
                    <span class="text">Глоссарий</span>
                </li>

                <!-- Сценарий использования с подменю -->
                <li class="nav-item with-submenu" data-content="usecase">
                    <i class="fas fa-globe"></i>
                    <span class="text">Сценарий использования</span>
                    <i class="fas fa-chevron-down submenu-arrow"></i>
                </li>
                <div class="submenu">
                    <ul>
                        <li class="submenu-item" data-content="usecase-main">
                            <i class="fas fa-user"></i>
                            <span class="text">Пользователь</span>
                        </li>
                        <li class="submenu-item" data-content="usecase-template">
                            <i class="fas fa-sitemap"></i>
                            <span class="text">Архитектурный проект</span>
                        </li>
                        <li class="submenu-item" data-content="usecase-application">
                            <i class="fas fa-project-diagram"></i>
                            <span class="text">Заявки</span>
                        </li>
                        <li class="submenu-item" data-content="usecase-order">
                            <i class="fas fa-info-circle"></i>
                            <span class="text">Заказы</span>
                        </li>
                    </ul>
                </div>

                <!-- Архитектура -->
                <li class="nav-item" data-content="architecture">
                    <i class="fas fa-sitemap icon"></i>
                    <span class="text">Архитектура</span>
                </li>

                <!-- Безопасность -->
                <li class="nav-item" data-content="security">
                    <i class="fas fa-shield-alt icon"></i>
                    <span class="text">Безопасность</span>
                </li>

                <!-- Инфраструктура с подменю -->
                <li class="nav-item with-submenu" data-content="infrastructure">
                    <i class="fas fa-server icon"></i>
                    <span class="text">Инфраструктура</span>
                    <i class="fas fa-chevron-down submenu-arrow"></i>
                </li>
                <div class="submenu">
                    <ul>
                        <li class="submenu-item" data-content="infrastructure-deployment">
                            <i class="fas fa-rocket icon"></i>
                            <span class="text">Деплоймент</span>
                        </li>
                        <li class="submenu-item" data-content="infrastructure-monitoring">
                            <i class="fas fa-chart-line icon"></i>
                            <span class="text">Мониторинг</span>
                        </li>
                        <li class="submenu-item" data-content="infrastructure-logs">
                            <i class="fas fa-hdd icon"></i>
                            <span class="text">Логирование</span>
                        </li>
                    </ul>
                </div>

                <!-- Фронтенд -->
                <li class="nav-item" data-content="frontend">
                    <i class="fas fa-paint-brush icon"></i>
                    <span class="text">Фронтенд</span>
                </li>

                <!-- Бэкенд -->
                <li class="nav-item" data-content="backend">
                    <i class="fas fa-code icon"></i>
                    <span class="text">Бэкенд</span>
                </li>
            </ul>
        </nav>

        <div class="sidebar-footer">
            <small>Версия 1.0.0</small>
        </div>
    </aside>

    <!-- Основной контент -->
    <main class="content">
        <div class="content-header">
            <button id="expandSidebar" class="expand-btn" title="Показать панель">
                <i class="fas fa-bars"></i>
            </button>
            <h1 id="content-title">Введение</h1>
        </div>

        <div class="content-body">
            <!-- Введение -->
            <div id="introduction" class="content-section active">
                <h2><i class="fas fa-home"></i> Введение</h2>
                <p>Документация по проекту, созданному в рамках практической работы 2 курса магистратуры по специальности "Разработка программного обеспечения" НИЯУ МИФИ.</p>

                <h3>Цель проекта</h3>
                <p>Создание современного веб-приложения для решения задачи обеспечения полного цикла заказа и строительства объектов индивидуального жилищного строительства.</p>

                <h3>Технологический стек</h3>
                <div class="tech-stack">
                    <div class="tech-item">
                        <span class="tech-label">FRONTEND:</span>
                        <span class="tech-value">React, JavaScript</span>
                    </div>
                    <div class="tech-item">
                        <span class="tech-label">BACKEND:</span>
                        <span class="tech-value">Java 21, Spring boot</span>
                    </div>
                    <div class="tech-item">
                        <span class="tech-label">DATABASE:</span>
                        <span class="tech-value">Postgresql, Flyway</span>
                    </div>
                    <div class="tech-item">
                        <span class="tech-label">SECURITY:</span>
                        <span class="tech-value">Spring Security, OAuth2, Keycloak</span>
                    </div>
                    <div class="tech-item">
                        <span class="tech-label">TEST:</span>
                        <span class="tech-value">JUnit, Mockito</span>
                    </div>
                    <div class="tech-item">
                        <span class="tech-label">DOCS:</span>
                        <span class="tech-value">Swagger, OpenAPI</span>
                    </div>
                    <div class="tech-item">
                        <span class="tech-label">OBSERVABILITY:</span>
                        <span class="tech-value">Grafana, Prometheus, Loki</span>
                    </div>
                    <div class="tech-item">
                        <span class="tech-label">Инфраструктура:</span>
                        <span class="tech-value">GitHub Actions, github, gitlab, k8s, Argo cd</span>
                    </div>
                </div>
            </div>

            <!-- Команда -->
            <div id="team" class="content-section">
                <h2><i class="fas fa-users"></i> Команда</h2>
                <p>Проект разрабатывается командой из 5 человек с распределением ролей:</p>

                <div class="team-grid">
                    <div class="team-member">
                        <h3>Алла</h3>
                        <p class="role">Тимлид/разработка</p>
                        <a href="https://github.com/alladavletshina" target="_blank" class="git">github.com/alladavletshina</a>
                    </div>
                    <div class="team-member">
                        <h3>Данис</h3>
                        <p class="role">Архитектура/инфраструктура/разработка</p>
                        <a href="https://github.com/Dan9191" target="_blank" class="git">github.com/Dan9191</a>
                    </div>
                    <div class="team-member">
                        <h3>Виталий</h3>
                        <p class="role">БД/разработка</p>
                        <a href="https://github.com/xRay1337" target="_blank" class="git">github.com/xRay1337</a>
                    </div>
                    <div class="team-member">
                        <h3>Михаил</h3>
                        <p class="role">Фронтенд</p>
                        <a href="https://github.com/OgBludo" target="_blank" class="git">github.com/OgBludo</a>
                    </div>
                    <div class="team-member">
                        <h3>Алина</h3>
                        <p class="role">Презентация</p>
                        <a href="https://github.com/AlinDev8" target="_blank" class="git">github.com/AlinDev8</a>
                    </div>
                </div>

            </div>

            <!-- Задание -->
            <div id="task" class="content-section">
                <h2><i class="fas fa-tasks"></i> Задание</h2>
                <p>Партнёр предлагает разработать мобильное приложение или сайт, которые обеспечивают полный цикл заказа и строительства объектов индивидуального жилищного строительства (ИЖС).</p>

                <p>Сервис должен поддерживать весь путь заказчика — от выбора проекта до завершения строительства и подписания финальных документов.</p>

                <h3>Целевая аудитория</h3>
                <ul>
                    <li>Люди, которые хотят заказать строительство объекта ИЖС.</li>
                    <li>Пользователи, которым нужен единый цифровой инструмент для выбора проекта, согласования документов, наблюдения за ходом стройки и завершения всех формальных процедур.</li>
                </ul>


                <h3>Основные задачи на хакатоне</h3>
                <p>Команда должна реализовать пользовательский путь, описанный в брифе.</p>
                <ol>
                    <li>
                        <h4>Выбор проекта.</h4>
                        <p>Пользователь заходит в систему, выбирает проект и отправляет запрос на его строительство.</p>
                    </li>
                    <li>
                        <h4>Согласование документации.</h4>
                        <p>Пользователь проходит этап согласования документов через систему.</p>
                    </li>
                    <li>
                        <h4>Этап строительства.</h4>
                        <ul>
                            <li>Отображение видеопотока со стройки.</li>
                            <li>Общение в чате со специалистом.</li>
                        </ul>
                    </li>
                    <li>
                        <h4>Завершение строительства.</h4>
                        <p>Подписание всех оставшихся документов после окончания строительства.</p>
                    </li>
                </ol>

                <h3>Ожидаемый результат</h3>
                <p>По итогам выполнения кейса участники должны представить:</p>
                <ol>
                    <li>Мобильное приложение или сайт, которые реализуют описанный путь пользователя: выбор проекта → согласование документации → просмотр видеопотока и чат → подписание документов.</li>
                    <li>Прототип, демонстрацию или рабочую версию, в которой этот путь можно воспроизвести.</li>
                </ol>

                <p>Участники должны учитывать все этапы, указанные в брифе.</p>

                <h3>Рекомендации для участников</h3>
                <ol>
                    <li>Внимательно придерживайтесь четырёх этапов пользовательского пути, указанного партнёром.</li>
                    <li>Используйте аналог как пример структуры и визуального решения.</li>
                    <li>Сосредоточьтесь на том, чтобы все этапы были последовательно связаны между собой.</li>
                    <li>Обеспечьте возможность продемонстрировать путь пользователя от начала до конца.</li>
                    <li>Не выходите за рамки брифа — реализуйте только то, что прямо указано партнёром.</li>
                </ol>

                <h3>Финальные артефакты</h3>
                <ol>
                    <li>Прототип мобильного приложения или сайта: отражает весь путь — выбор проекта → согласование документов → стройка (видео + чат) → подписание документов.</li>
                    <li>Демонстрация пользовательского сценария: видео или презентация с проходом всех этапов.</li>
                    <li>Краткое описание решения: как реализованы четыре шага из брифа.</li>
                    <li>Набор экранов/макетов: все ключевые этапы пользовательского пути.</li>
                </ol>

            </div>

            <!-- Глоссарий -->
            <div id="glossary" class="content-section">
                <h2><i class="fas fa-book-open"></i> Глоссарий</h2>
                <p>Определения ключевых терминов, используемых в проекте:</p>

                <div class="glossary-list">
                    <div class="term">
                        <h3>Клиент</h3>
                        <p>Физическое или юридическое лицо (Заказчик), выразившее намерение заключить договор подряда на выполнение работ по индивидуальному жилищному строительству (ИЖС) с Исполнителем. </p>
                    </div>

                    <div class="term">
                        <h3>Проект (Типовой/Архитектурный проект)</h3>
                        <p>Утверждённый комплект проектно-сметной документации, включающий архитектурные, конструктивные и инженерные разделы, а также визуализации объекта. Является основным коммерческим предложением и базой для формирования Заказа. </p>
                    </div>

                    <div class="term">
                        <h3>Заявка</h3>
                        <p>Формализованное обращение Клиента, содержащее выбранный Проект и реквизиты для связи. Инициирует процесс предварительного рассмотрения возможности заключения договора.</p>
                    </div>

                    <div class="term">
                        <h3>Статус заявки</h3>
                        <p>Атрибут, определяющий текущее состояние обработки Заявки в рабочем процессе Компании.</p>
                        <ul>
                            <li>
                                <span class="text">Создана — Заявка зарегистрирована в системе.</span>
                            </li>
                            <li>
                                <span class="text">На рассмотрении — Заявка находится в работе у ответственного Менеджера.</span>
                            </li>
                            <li>
                                <span class="text">По Заявке принято положительное решение, инициировано создание Заказа.</span>
                            </li>
                            <li>
                                <span class="text">По Заявке принято отрицательное решение с указанием причины.</span>
                            </li>
                        </ul>
                    </div>

                    <div class="term">
                        <h3>Менеджер проекта</h3>
                        <p>Уполномоченный сотрудник Компании (Исполнителя), ответственный за взаимодействие с Клиентом, администрирование коммерческих условий, координацию этапов работ и ведение документации в рамках конкретного Заказа.</p>
                    </div>

                    <div class="term">
                        <h3>Заказ</h3>
                        <p>Основной учётный объект, представляющий собой совокупность данных о выполняемых работах по конкретному объекту Клиента. Содержит ссылку на Проект, документацию, историю коммуникаций, данные о ходе строительства и является юридическим и финансовым отражением Договора подряда в информационной системе.</p>
                    </div>

                    <div class="term">
                        <h3>Статус заказа</h3>
                        <p>Атрибут, отражающий текущую фазу исполнения Заказа в соответствии с утверждённым проектом и календарным планом.</p>
                        <ul>
                            <li>
                                <span class="text">Новый заказ — Заказ создан, ведутся подготовительные и организационные работы.</span>
                            </li>
                            <li>
                                <span class="text">Подготовка документации — Формирование и согласование пакета разрешительной и рабочей документации.</span>
                            </li>
                            <li>
                                <span class="text">Строительство — На объекте ведутся активные строительно-монтажные работы (детализируются Этапами строительства).</span>
                            </li>
                            <li>
                                <span class="text">Завершение работ — Выполнены основные работы, идёт процесс финальных согласований, устранения замечаний, подготовки к сдаче.</span>
                            </li>
                            <li>
                                <span class="text">Заказ закрыт — Объект сдан Клиенту, все обязательства исполнены, акты подписаны.</span>
                            </li>
                            <li>
                                <span class="text">Заказ отменен — Исполнение Заказа прекращено на основании расторжения Договора.</span>
                            </li>
                        </ul>
                    </div>

                    <div class="term">
                        <h3>Этап строительства</h3>
                        <p>Конкретный технологический процесс или комплекс работ в рамках статуса Заказа «Строительство». Служит для детального планирования, контроля и отчётности о ходе строительно-монтажных работ</p>
                    </div>

                    <div class="term">
                        <h3>Перечень этапов строительства:</h3>
                        <ul>
                            <li>
                                <span class="text">Подготовка участка: расчистка и разметка.</span>
                            </li>
                            <li>
                                <span class="text">Земляные работы: разработка котлована и траншей.</span>
                            </li>
                            <li>
                                <span class="text">Заливка фундамента.</span>
                            </li>
                            <li>
                                <span class="text">Возведение стен.</span>
                            </li>
                            <li>
                                <span class="text">Устройство межэтажных перекрытий и лестниц.</span>
                            </li>
                            <li>
                                <span class="text">Монтаж кровли.</span>
                            </li>
                            <li>
                                <span class="text">Установка окон и дверей.</span>
                            </li>
                            <li>
                                <span class="text">Наружная отделка и утепление фасада.</span>
                            </li>
                            <li>
                                <span class="text">Дополнительное утепление наружных стен.</span>
                            </li>
                            <li>
                                <span class="text">Электромонтажные работы.</span>
                            </li>
                            <li>
                                <span class="text">Сантехнические работы.</span>
                            </li>
                            <li>
                                <span class="text">Монтаж отопления и вентиляции.</span>
                            </li>
                            <li>
                                <span class="text">Выравнивание стен и потолков.</span>
                            </li>
                            <li>
                                <span class="text">Финишная внутренняя отделка.</span>
                            </li>
                            <li>
                                <span class="text">Укладка напольных покрытий.</span>
                            </li>
                            <li>
                                <span class="text">Покраска и декорирование помещений.</span>
                            </li>
                            <li>
                                <span class="text">Благоустройство территории.</span>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>

            <!-- Сценарий использования Описание -->
            <div id="usecase" class="content-section">
                <h2><i class="fas fa-globe"></i> Сценарий использования: Общая</h2>
                <div class="scenario-content">
                    <h3>Назначение системы</h3>
                    <p>Система автоматизации строительной компании ИЖС управляет полным циклом взаимодействия с клиентами: от выбора проекта до завершения строительства.</p>

                    <h3>Ключевые роли</h3>
                    <div class="roles">
                        <div class="role">
                            <i class="fas fa-user"></i>
                            <strong>Клиент</strong>
                            <p>Заказчик, желающий построить дом</p>
                        </div>
                        <div class="role">
                            <i class="fas fa-user-tie"></i>
                            <strong>Менеджер</strong>
                            <p>Сотрудник компании, обрабатывающий заявки и ведущий заказы</p>
                        </div>
                    </div>

                    <h3>Основной бизнес-процесс</h3>
                    <div class="mermaid">
                        flowchart TD
                        A[Клиент регистрируется] --> B[Выбирает проект]
                        B --> C[Создает заявку<br/>с контактами]
                        C --> D{Менеджер связывается<br/>с клиентом}
                        D --> E[Создается заказ]
                        D --> F[Заявка отклонена]
                        E --> G[Выполняется строительство]
                        G --> H[Заказ завершен]
                    </div>
                </div>
            </div>

            <!-- Сценарий использования - Пользователь -->
            <div id="usecase-main" class="content-section">
                <h2><i class="fas fa-user"></i> Сценарий использования: Пользователь</h2>
                <div class="scenario-content">
                    <h3>Основные сценарии работы с пользователями</h3>

                    <div class="mermaid">
                        flowchart TD
                        Start[Вход на сайт] --> AuthCheck{Авторизован?}

                        AuthCheck -->|Нет| Register[Регистрация]
                        AuthCheck -->|Да| Profile[Профиль]

                        Register --> Auth[Авторизация]
                        Profile --> Edit[Редактирование]

                        Auth --> RoleCheck{Роль?}
                        RoleCheck -->|hackathon.user| Client[Клиент]
                        RoleCheck -->|hackathon.manager| Manager[Менеджер]
                    </div>

                    <h4>1. Регистрация пользователя</h4>
                    <div class="steps">
                        <div class="step"><strong>1.</strong> Переход на страницу регистрации</div>
                        <div class="step"><strong>2.</strong> Заполнение данных: email, пароль, фамилия, имя</div>
                        <div class="step"><strong>3.</strong> Нажатие "Зарегистрироваться"</div>
                        <div class="step"><strong>4.</strong> Происходит создание пользователя в Keycloak + сохранение профиля в БД</div>
                        <div class="step"><strong>5.</strong> Автоматическая авторизация</div>
                    </div>

                    <h4>2. Авторизация</h4>
                    <div class="steps">
                        <div class="step"><strong>1.</strong> Нажатие "Войти"</div>
                        <div class="step"><strong>2.</strong> Ввод данных</div>
                        <div class="step"><strong>3.</strong> Отправка запроса в Keycloak</div>
                        <div class="step"><strong>5.</strong> Получение JWT токена</div>
                        <div class="step"><strong>6.</strong> Авторизация</div>
                    </div>

                    <h4>3. Редактирование профиля</h4>
                    <div class="steps">
                        <div class="step"><strong>1.</strong> Переход в "Мой профиль"</div>
                        <div class="step"><strong>2.</strong> Нажатие "Редактировать"</div>
                        <div class="step"><strong>3.</strong> Изменение данных (ФИО, email)</div>
                        <div class="step"><strong>4.</strong> Сохранение изменений</div>
                        <div class="step"><strong>5.</strong> Обновление данных в PostgreSQL</div>
                    </div>
                </div>
            </div>

            <!-- Сценарий использования - Шаблон -->
            <div id="usecase-template" class="content-section">
                <h2><i class="fas fa-sitemap"></i> Сценарий использования: Шаблон проекта</h2>

                <div class="scenario-content">
                    <h3>Управление проектами</h3>

                    <div class="mermaid">
                        flowchart TD
                        Start[Архитектурные проекты] --> Auth{Роль?}

                        Auth -->|Гость/Клиент| ViewActive[Просмотр активных]
                        ViewActive --> Select[Выбор для заявки]

                        Auth -->|Менеджер| Management[Управление]
                        Management --> Create[Создать]
                        Management --> Edit[Редактировать]
                        Management --> Toggle[Сменить статус]
                        Management --> Delete[Удалить]

                        Create --> Status{Статус?}
                        Status -->|Активен| AllVisible[Виден всем]
                        Status -->|Неактивен| OnlyManagers[Только менеджерам]
                    </div>

                    <h3>Доступ по ролям</h3>
                    <table class="access-table">
                        <tr>
                            <th>Действие</th>
                            <th>Гость</th>
                            <th>Клиент</th>
                            <th>Менеджер</th>
                        </tr>
                        <tr>
                            <td>Просмотр активных проектов</td>
                            <td><i class="fas fa-check text-success"></i></td>
                            <td><i class="fas fa-check text-success"></i></td>
                            <td><i class="fas fa-check text-success"></i></td>
                        </tr>
                        <tr>
                            <td>Просмотр неактивных</td>
                            <td><i class="fas fa-times text-danger"></i></td>
                            <td><i class="fas fa-times text-danger"></i></td>
                            <td><i class="fas fa-check text-success"></i></td>
                        </tr>
                        <tr>
                            <td>Создание проекта</td>
                            <td><i class="fas fa-times text-danger"></i></td>
                            <td><i class="fas fa-times text-danger"></i></td>
                            <td><i class="fas fa-check text-success"></i></td>
                        </tr>
                        <tr>
                            <td>Редактирование проекта</td>
                            <td><i class="fas fa-times text-danger"></i></td>
                            <td><i class="fas fa-times text-danger"></i></td>
                            <td><i class="fas fa-check text-success"></i></td>
                        </tr>
                        <tr>
                            <td>Удаление проекта</td>
                            <td><i class="fas fa-times text-danger"></i></td>
                            <td><i class="fas fa-times text-danger"></i></td>
                            <td><i class="fas fa-check text-success"></i></td>
                        </tr>
                    </table>

                    <h4>1. Создание проекта (только менеджер)</h4>
                    <ol>
                        <li>Переход на главную страницу → "Создать шаблон"</li>
                        <li>Заполнение данных: название, описание, характеристики</li>
                        <li>Загрузка изображений и технической документации</li>
                        <li>Указание статуса: <strong>Активен</strong> или <strong>Неактивен</strong></li>
                        <li>Сохранение проекта</li>
                    </ol>

                    <h4>2. Редактирование проекта</h4>
                    <ol>
                        <li>Выбор проекта из списка</li>
                        <li>Нажатие "Редактировать"</li>
                        <li>Внесение изменений</li>
                        <li>Обновление файлов при необходимости</li>
                        <li>Сохранение изменений</li>
                    </ol>

                    <h4>3. Смена статуса</h4>
                    <div class="status-info">
                        <div class="status active">
                            <strong>Активен</strong>
                            <p>Проект виден всем пользователям, включая неавторизованных</p>
                        </div>
                        <div class="status inactive">
                            <strong>Неактивен</strong>
                            <p>Проект виден только менеджерам в административном интерфейсе</p>
                        </div>
                    </div>

                    <h4>4. Удаление проекта</h4>
                    <ol>
                        <li>Выбор проекта → "Удалить"</li>
                        <li>Подтверждение действия</li>
                        <li>Проверка отсутствия активных заявок на проект</li>
                        <li>Удаление проекта из системы</li>
                    </ol>
                </div>
            </div>

            <!-- Сценарий использования - заявка -->
            <div id="usecase-application" class="content-section">
                <h2><i class="fas fa-project-diagram"></i> Сценарий использования: Заявка</h2>
                <div class="scenario-content">
                    <h3>Жизненный цикл заявки</h3>

                    <div class="mermaid">
                        flowchart TD
                        A[Создана<br/>Клиент оставил заявку] --> B[В рассмотрении<br/>Менеджер связывается]

                        B --> C{Решение}

                        C -->|Принято| D[Принята<br/>Создается заказ]
                        C -->|Отклонено| E[Отклонена<br/>Заявка не принята]
                    </div>

                    <h4>1. Создание заявки (Клиент)</h4>
                    <ol>
                        <li>Просмотр каталога активных проектов</li>
                        <li>Выбор проекта → "Оставить заявку"</li>
                        <li>Передача контактных данных</li>
                        <li>Нажатие "Отправить заявку"</li>
                        <li>Происходит создание заявки со статусом <strong>"Создана"</strong></li>
                        <li>Происходит добавление заявки в список новых заявок (для Менеджер)</li>
                    </ol>

                    <h4>2. Взятие в работу (Менеджер)</h4>
                    <ol>
                        <li>Просмотр списка новых заявок</li>
                        <li>Выбор заявки → "Взять в работу"</li>
                        <li>Происходит смена статуса на <strong>"В рассмотрении"</strong></li>
                        <li><strong>Связь с клиентом</strong> по предоставленным контактам</li>
                        <li>Уточнение деталей и обсуждение условий</li>
                    </ol>

                    <h4>3. Принятие заявки (Менеджер)</h4>
                    <ol>
                        <li>После согласования с клиентом</li>
                        <li>Нажатие "Принять заявку"</li>
                        <li>Подтверждение действия</li>
                        <li>Происходит смена статуса на <strong>"Принята"</strong></li>
                        <li>Происходит автоматическое создание <strong>Заказа</strong></li>
                    </ol>

                    <h4>4. Отклонение заявки (Менеджер)</h4>
                    <ol>
                        <li>Нажатие "Отклонить заявку"</li>
                        <li>Подтверждение действия</li>
                        <li>Происходит смена статуса на <strong>"Отклонена"</strong></li>
                        <li><em>Причина отклонения обсуждается с клиентом вне системы</em></li>
                    </ol>
                </div>
            </div>

            <!-- Сценарий использования - заказ -->
            <div id="usecase-order" class="content-section">
                <h2><i class="fas fa-info-circle"></i> Сценарий использования: Заказ</h2>
                    <h3>Жизненный цикл заказа</h3>

                    <div class="mermaid">
                        flowchart TD
                        A[Создан заказ<br/>Статус: Новый заказ]
                        A --> B[Менеджер<br/>Согласование предварительной сметы и условий с клиентом]
                        B --> C{Клиент cогласен?}
                        C -->|Да| D[Менеджер продолжает работу с клиентом<br/>Статус: Подготовка документации]
                        C -->|Нет| E[Менеджер отменяет заказ<br/>Cтатус: Заказ отменен]
                        D --> F[Менеджер<br/>Подбор подходящего участка совместно с клиентом]
                        F --> G[Менеджер<br/>Проверка документов на землю и подготовка документации]
                        G --> H[Клиент<br/>Подписание документации и внесение оплаты]
                        H --> I[Менеджер<br/>Получение разрешения на строительство]
                        I --> J[Старт строительных работ<br/>Cтатус: Строительство]
                        J --> K[Менеджер<br/>Планирование и запуск строительных работ по этапу]
                        K --> L[Клиент<br/>Отслеживание хода строительных работ через камеры]
                        L --> M[Клиент<br/>Связь с менеджером/прорабом в чате]
                        M --> N[Приемка этапа клиентом<br/>подтверждение в чате/подписание акта]
                        N --> O{Строительные работы<br/>завершены?}
                        O -->|Нет| K[Менеджер<br/>Планирование и запуск строительных работ по этапу]
                        O -->|Да| P[Все строительные этапы работ завершены<br/>Cтатус: Завершение работ]
                        P --> R[Клиент<br/>Финальная приемка готового жилья, замечания]
                        R --> S[Менеджер<br/>Устранение замечаний, оформление актов сдачи-приемки]
                        S --> T[Клиент<br/>Подписание актов, финальная оплата]
                        T --> U[Менеджер<br/>Передача ключей и документации клиенту]
                        U --> V[Заказ завершен<br/>Статус: Заказ закрыт]
                    </div>

                    <h4>1. Создание заявки (Клиент)</h4>
                    <ol>
                        <li>Просмотр каталога активных проектов</li>
                        <li>Выбор проекта → "Оставить заявку"</li>
                        <li>Передача контактных данных</li>
                        <li>Нажатие "Отправить заявку"</li>
                        <li>Происходит создание заявки со статусом <strong>"Создана"</strong></li>
                        <li>Происходит добавление заявки в список новых заявок (для Менеджер)</li>
                    </ol>

                    <h4>2. Взятие в работу (Менеджер)</h4>
                    <ol>
                        <li>Просмотр списка новых заявок</li>
                        <li>Выбор заявки → "Взять в работу"</li>
                        <li>Происходит смена статуса на <strong>"В рассмотрении"</strong></li>
                        <li><strong>Связь с клиентом</strong> по предоставленным контактам</li>
                        <li>Уточнение деталей и обсуждение условий</li>
                    </ol>

                    <h4>3. Принятие заявки (Менеджер)</h4>
                    <ol>
                        <li>После согласования с клиентом</li>
                        <li>Нажатие "Принять заявку"</li>
                        <li>Подтверждение действия</li>
                        <li>Происходит смена статуса на <strong>"Принята"</strong></li>
                        <li>Происходит автоматическое создание <strong>Заказа</strong></li>
                    </ol>

                    <h4>4. Отклонение заявки (Менеджер)</h4>
                    <ol>
                        <li>Нажатие "Отклонить заявку"</li>
                        <li>Подтверждение действия</li>
                        <li>Происходит смена статуса на <strong>"Отклонена"</strong></li>
                        <li><em>Причина отклонения обсуждается с клиентом вне системы</em></li>
                    </ol>
                </div>

            <!-- Архитектура -->
            <div id="architecture" class="content-section">
                <h2><i class="fas fa-sitemap"></i> Архитектура</h2>

                <h3>Общая архитектура</h3>
                <p>Система построена по трехуровневой клиент-серверной архитектуре, развёрнутой в Kubernetes-кластере.</p>

                <div class="mermaid">
                    flowchart TD

                    subgraph "Серверная сторона"
                    Backend[Backend Application<br/>Spring Boot / Java 21]
                    Keycloak[Keycloak<br/>Сервис аутентификации]
                    end

                    subgraph "Хранение данных"
                    PostgreSQL[(PostgreSQL<br/>Бизнес-данные<br/>Проекты, заявки, заказы)]
                    end

                    subgraph "Клиентская сторона"
                    Browser[Веб-браузер<br/>React SPA]
                    end

                    Browser -- "1. Аутентификация<br/>(прямой OAuth2/OIDC flow)" --> Keycloak
                    Keycloak -- "2. Возвращает JWT токен" --> Browser
                    Browser -- "3. Все API-запросы с JWT в заголовке" --> Backend
                    Backend -- "4. Валидация токена<br/>(при необходимости)" --> Keycloak
                    Backend -- "5. Работа с бизнес-данными" --> PostgreSQL
                    Browser -- "6. Регистрация нового пользователя<br/>POST /api/users" --> Backend
                    Backend -- "7. Создание учётной записи<br/>через Admin REST API" --> Keycloak
                    Backend -- "8. Сохранение профиля пользователя" --> PostgreSQL
                </div>

                <h3>Компоненты системы</h3>
                <table>
                    <tr>
                        <th>Компонент</th>
                        <th>Назначение</th>
                    </tr>
                    <tr>
                        <td>Клиентское приложение (Frontend)</td>
                        <td>SPA на React, обслуживаемое отдельным веб-сервером.</td>
                    </tr>
                    <tr>
                        <td>Серверное приложение (Backend)</td>
                        <td>Монолитное Spring Boot приложение на Java 21.</td>
                    </tr>
                    <tr>
                        <td>Сервис аутентификации</td>
                        <td>Keycloak, отвечающий за управление учётными записями.</td>
                    </tr>
                    <tr>
                        <td>База данных</td>
                        <td>PostgreSQL для хранения бизнес-данных.</td>
                    </tr>
                </table>
            </div>

            <!-- Безопасность -->
            <div id="security" class="content-section">
                <h2><i class="fas fa-shield-alt"></i> Безопасность</h2>

                <h3>1. Общий подход</h3>
                <p>
                    Все компоненты взаимодействуют по защищённым каналам связи с использованием HTTPS. Аутентификация и авторизация централизованы через сервис Keycloak.
                </p>

                <h3>2. Защита передаваемых данных</h3>
                <ul>
                    <li>HTTPS повсеместно: Все коммуникации между компонентами шифруются с использованием TLS.</li>
                    <li>Сертификаты: В Kubernetes-кластере настроена автоматическая выдача и обновление SSL-сертификатов (через Cert-Manager с Let's Encrypt).</li>
                    <li>JWT-токены: Все API-запросы содержат подписанные JWT-токены в заголовке</li>
                </ul>

                <h3>3. Сервис аутентификации и авторизации (Keycloak)</h3>
                <ul>
                    <li><b>Realm:</b> Создан отдельный realm hackathon для изоляции окружения.</li>
                    <li><b>Клиенты:</b>
                        <ul>
                            <li>hackathon-cli — клиент для веб-приложения (публичный).</li>
                            <li>hackathon-backend — клиент для серверного приложения (конфиденциальный).</li>
                        </ul>
                    </li>
                </ul>

                <h3>4. Ролевая модель (RBAC)</h3>
                <p>Роли в Keycloak:</p>
                <ul>
                    <li>hackathon.user — базовая роль для клиентов</li>
                    <li>hackathon.manager — роль для менеджеров строительной компании</li>
                </ul>

                <h4>Применение ролей:</h4>
                <ul>
                    <li>Роли добавляются пользователям в Keycloak администратором</li>
                    <li>JWT токен содержит список ролей пользователя</li>
                    <li>Backend валидирует наличие необходимых ролей для доступа к эндпоинтам</li>
                    <li>Frontend динамически изменяет интерфейс в зависимости от ролей пользователя</li>
                </ul>

                <h4>Пример JWT токена:</h4>
                <pre><code>{
  "exp": 1768154817,
  "iat": 1768154517,
  "jti": "onrtro:1214304c-9d88-4ce5-94d7-7ac3264c0e4f",
  "iss": "https://auth.mos-hack.ru/realms/hackathon",
  "aud": "account",
  "sub": "9b632fd5-6631-492e-b691-cbcc38abdb47",
  "typ": "Bearer",
  "azp": "hackathon-cli",
  "sid": "5ae40795-19fb-4f71-af99-e43694838d4d",
  "acr": "1",
  "allowed-origins": [
    "*"
  ],
  "realm_access": {
    "roles": [
      "offline_access",
      "hackathon.user",
      "uma_authorization",
      "default-roles-hackathon"
    ]
  },
  "resource_access": {
    "account": {
      "roles": [
        "manage-account",
        "manage-account-links",
        "view-profile"
      ]
    }
  },
  "scope": "email profile",
  "email_verified": true,
  "roles": [
    "ROLE_offline_access",
    "ROLE_uma_authorization",
    "ROLE_hackathon.user",
    "ROLE_default-roles-hackathon",
    "ROLE_manage-account",
    "ROLE_view-profile",
    "ROLE_manage-account-links"
  ],
  "name": "user user",
  "preferred_username": "user",
  "given_name": "user",
  "family_name": "user",
  "email": "user@mail.com"
}</code></pre>
            </div>

            <!-- Основной контент для "Инфраструктура" -->
            <div id="infrastructure" class="content-section">
                <h2><i class="fas fa-server"></i> Инфраструктура</h2>

                <h3>1.1. Обзор инфраструктуры</h3>
                <p>Система развернута в собственноручно управляемом Kubernetes-кластере на виртуальных серверах облачного провайдера Beget.com. Архитектура построена на принципах GitOps с использованием Argo CD для автоматического развертывания.</p>

                <h3>1.2. Компоненты инфраструктуры</h3>
                <h4>Вычислительные ресурсы:</h4>
                <table>
                    <tr>
                        <th>Компонент</th>
                        <th>Назначение</th>
                    </tr>
                    <tr>
                        <td>Control Plane</td>
                        <td>1 мастер-нода</td>
                    </tr>
                    <tr>
                        <td>Worker Nodes</td>
                        <td>2 worker-ноды для запуска рабочих нагрузок.</td>
                    </tr>
                </table>
                <h4>Сервисы инфраструктуры:</h4>
                <table>
                    <tr>
                        <th>Компонент</th>
                        <th>Назначение</th>
                    </tr>
                    <tr>
                        <td>Argo CD</td>
                        <td>GitOps-оператор для непрерывного развертывания</td>
                    </tr>
                    <tr>
                        <td>Cert-Manager</td>
                        <td>Автоматическое управление TLS-сертификатами от Let's Encrypt</td>
                    </tr>
                    <tr>
                        <td>PostgreSQL</td>
                        <td>База данных приложения (StatefulSet)</td>
                    </tr>
                    <tr>
                        <td>Keycloak</td>
                        <td>Сервис аутентификации и авторизации</td>
                    </tr>
                </table>


                <h4>Мониторинг и логирование:</h4>
                <table>
                    <tr>
                        <th>Компонент</th>
                        <th>Назначение</th>
                    </tr>
                    <tr>
                        <td>Prometheus:</td>
                        <td>Сбор и хранение метрик</td>
                    </tr>
                    <tr>
                        <td>Alloy</td>
                        <td>Агент для сбора и передачи логов в Loki</td>
                    </tr>
                    <tr>
                        <td>Loki</td>
                        <td>Хранение логов</td>
                    </tr>
                    <tr>
                        <td>Grafana</td>
                        <td>Агент для сбора и передачи логов в Loki</td>
                    </tr>
                </table>

            </div>

            <!-- Инфраструктура - Деплоймент -->
            <div id="infrastructure-deployment" class="content-section">
                <h3>2.1. GitOps-архитектура</h3>
                <p>Развертывание построено на принципах GitOps с использованием Argo CD в качестве оператора доставки. Инфраструктурный репозиторий в GitLab является "источником истины".</p>

                <div class="mermaid">
                    graph LR
                    GitHub[GitHub Repos] --> GHCR[GHCR]
                    GHCR --> GitLab[GitLab Infra]
                    GitLab[GitLab Infra] --> ArgoCD[Argo CD]
                    ArgoCD --> K8s[Kubernetes]
                </div>

                <h3>2.2. Процесс непрерывного развертывания</h3>
                <h4>Этапы CI/CD pipeline:</h4>
                <ol>
                    <li>
                        <p></p><b>Разработка</b> → Push кода в GitHub репозиторий</p>
                    </li>
                    <li>
                        <b>CI Pipeline (GitHub Actions):</b>
                        <ul>
                            <li>Сборка приложения</li>
                            <li>Запуск тестов</li>
                            <li>Сборка Docker-образа</li>
                            <li>Пуш образа в GitHub Container Registry</li>
                            <li>Автоматическое обновление тега образа в GitLab репозитории</li>
                        </ul>
                    </li>
                    <li>
                        <b>CD Pipeline (Argo CD):</b>
                        <ul>
                            <li>Обнаружение изменений в GitLab репозитории</li>
                            <li>Синхронизация состояния кластера с манифестами</li>
                            <li>Развертывание нового образа в Kubernetes</li>
                            <li>Health-чеки и автоматический rollback при неудаче</li>
                        </ul>
                    </li>
                </ol>

                <h3>2.3. Переменные окружения и секреты</h3>
                <ul>
                    <li><b>GitHub Actions Secrets:</b> Токены для доступа к GitLab и GHCR</li>
                    <li><b>Kubernetes Secrets:</b> Хранятся в зашифрованном виде в кластере</li>
                    <li><b>ConfigMaps:</b> Конфигурации приложений, управляемые через Git</li>
                </ul>


            </div>

            <!-- Инфраструктура - Мониторинг -->
            <div id="infrastructure-monitoring" class="content-section">
                <h2><i class="fas fa-chart-line"></i> Инфраструктура: Мониторинг</h2>

                <img src="images/prom.png" alt="arch" style="max-width: 100%; height: auto;">
                <h3>3.1. Архитектура мониторинга</h3>
                <p>Система мониторинга построена на стеке Prometheus + Grafana с кастомными дашбордами для наблюдения за состоянием приложения и инфраструктуры.</p>

                <h3>3.2. Компоненты мониторинга</h3>
                <h4>3.2.1. Сбор метрик:</h4>
                <ul>
                    <li><b>Prometheus:</b> Основной сервер сбора метрик</li>
                    <li><b>Micrometer:</b> Интеграция с Spring Boot приложением</li>
                    <li><b>Kubernetes Metrics API:</b> Метрики кластера и нод</li>
                </ul>

                <h4>3.2.2. Конфигурация мониторинга бэкенда:</h4>
                <ul>
                    <li>Включена зависимость: io.micrometer:micrometer-registry-prometheus</li>
                    <li>Endpoint: /actuator/prometheus доступен только изнутри кластера</li>
                </ul>

                <h3>3.3. Дашборды Grafana</h3>
                <h4>3.3.1. Импортированные дашборды:</h4>
                <ul>
                    <li><b>ID 4701:</b> JVM (Micrometer)" для мониторинга Spring Boot приложения</li>
                    <li><b>ID 3119 :</b> Дашборд для мониторинга кластера</li>
                </ul>
            </div>

            <!-- Инфраструктура - Логирование -->
            <div id="infrastructure-logs" class="content-section">
                <h2><i class="fas fa-hdd"></i> Инфраструктура: Логирование</h2>
                <img src="images/logs.png" alt="arch" style="max-width: 100%; height: auto;">
                <h3>4.1. Архитектура сбора логов</h3>
                <p>Централизованная система логирования на базе стека Loki + Grafana + Alloy. Логи собираются со всех компонентов системы и доступны для поиска и анализа.</p>

                <h3>4.2. Компоненты системы логирования</h3>
                <h4>4.2.1. Alloy (агент сбора):</h4>
                <ol>
                    <li>Собирает логи контейнеров</li>
                    <li>Отправляет логи в Loki в сжатом виде</li>
                </ol>

                <h4>4.2.2. Loki (хранилище логов):</h4>
                <ol>
                    <li>Горизонтально масштабируемое хранилище</li>
                    <li>Хранение логов: 7 дней</li>
                </ol>

                <h4>4.2.3. Grafana (визуализация):</h4>
                <p>Loki datasource для поиска и анализа логов</p>
            </div>

            <!-- Фронтенд -->
            <div id="frontend" class="content-section">
                <h2><i class="fas fa-paint-brush"></i> Фронтенд</h2>

                <h3>Описание</h3>
                <p>Сервис, реализующий клиентский слой</p>

                <h3>Репозиторий</h3>
                <p><a href="https://github.com/Dan9191/react-hackathon-demo" target="_blank">https://github.com/Dan9191/react-hackathon-demo</a></p>

                <h3>Образ</h3>
                <p>Последний образ доступен на странице <a href="https://github.com/Dan9191/react-hackathon-demo/pkgs/container/react-hackathon-demo" target="_blank">https://github.com/Dan9191/react-hackathon-demo/pkgs/container/react-hackathon-demo</a></p>

                <h3>Стэк</h3>
                <p>Требуется Node js 22.</p>

                <h4>Установка зависимостей</h4>
                <pre><code>npm install</code></pre>

                <h4>Запуск</h4>
                <pre><code>npm run dev</code></pre>

                <h3>Конфигурация</h3>
                <p>Настройки в <code>public/auth-config.json</code>:</p>
                <p>Настройки в <code>public/config.json</code>:</p>
                <table>
                    <thead>
                    <tr>
                        <th>Переменная</th>
                        <th>Значение по умолчанию</th>
                        <th>Описание</th>
                    </tr>
                    </thead>
                    <tbody>
                    <tr>
                        <td>KEYCLOAK_URL</td>
                        <td>https://auth.mos-hack.ru/</td>
                        <td>URL keycloak</td>
                    </tr>
                    <tr>
                        <td>REALM</td>
                        <td>hackathon</td>
                        <td>Название REALM</td>
                    </tr>
                    <tr>
                        <td>CLIENT_ID</td>
                        <td>hackathon-cli</td>
                        <td>Клиент keycloak для фронтенда</td>
                    </tr>
                    <tr>
                        <td>API_BASE_URL</td>
                        <td>https://api.mos-hack.ru</td>
                        <td>Базовый URL бэкенда</td>
                    </tr>
                    </tbody>
                </table>

                <h3>Ресурсы kubernetes</h3>

                <h4>Argo cd</h4>
                <pre><code>apiVersion: argoproj.io/v1alpha1
kind: Application
metadata:
  name: mos-frontend
  namespace: argocd
spec:
  project: default
  source:
    repoURL: **********
    targetRevision: main
    path: apps/mos/frontend
  destination:
    server: https://kubernetes.default.svc
    namespace: mos-frontend
  syncPolicy:
    automated:
      prune: true
      selfHeal: true
    syncOptions:
      - CreateNamespace=true</code></pre>

                <h4>ConfigMap</h4>
                <pre><code>apiVersion: v1
kind: ConfigMap
metadata:
  name: mos-config
  namespace: mos-frontend
data:
  config.json: |
    {
      "API_BASE_URL": "https://api.mos-hack.ru",
      "TEMPLATES_LIST_URL": "/api/templates",
      "TEMPLATES_CREATE_URL": "/api/templates"
    }
  auth-config.json: |
    {
      "KEYCLOAK_URL": "https://auth.mos-hack.ru/",
      "REALM": "hackathon",
      "CLIENT_ID": "hackathon-cli"
    }</code></pre>

                <h4>Deployment</h4>
                <pre><code>apiVersion: apps/v1
kind: Deployment
metadata:
  name: mos-deployment
  namespace: mos-frontend
spec:
  replicas: 1
  selector:
    matchLabels:
      app: mos-frontend
  template:
    metadata:
      labels:
        app: mos-frontend
    spec:
      containers:
        - name: mos-frontend
          image: ghcr.io/dan9191/react-hackathon-demo:sha-11d328686b007310942d98d46fda2e334d8f5acc
          ports:
            - containerPort: 80
          volumeMounts:
            - name: config-volume
              mountPath: /usr/share/nginx/html/config.json
              subPath: config.json
            - name: config-volume
              mountPath: /usr/share/nginx/html/auth-config.json
              subPath: auth-config.json
          resources:
            requests:
              memory: "64Mi"
              cpu: "100m"
            limits:
              memory: "128Mi"
              cpu: "200m"
      volumes:
        - name: config-volume
          configMap:
            name: mos-config
</code></pre>

                <h4>Ingress</h4>
                <pre><code>apiVersion: networking.k8s.io/v1
kind: Ingress
metadata:
  name: mos-ingress
  namespace: mos-frontend
  annotations:
    nginx.ingress.kubernetes.io/ssl-redirect: "true"
    nginx.ingress.kubernetes.io/force-ssl-redirect: "true"
spec:
  ingressClassName: nginx
  tls:
    - hosts:
        - mos-hack.ru
      secretName: mos-frontend-tls
  rules:
    - host: mos-hack.ru
      http:
        paths:
          - path: /
            pathType: Prefix
            backend:
              service:
                name: mos-service
                port:
                  number: 80
</code></pre>

                <h4>Kustomization</h4>
                <pre><code>apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
namespace: mos-frontend
resources:
  - deployment.yaml
  - service.yaml
  - ingress.yaml
  - configmap.yaml
</code></pre>

                <h4>Service</h4>
                <pre><code>apiVersion: v1
kind: Service
metadata:
  name: mos-service
  namespace: mos-frontend
spec:
  selector:
    app: mos-frontend
  ports:
    - port: 80
      targetPort: 80
  type: ClusterIP
</code></pre>

            </div>

            <!-- Бэкенд -->
            <div id="backend" class="content-section">

                <h3>Описание</h3>
                <p>Сервис, которые обеспечивают полный цикл заказа и строительства объектов индивидуального жилищного строительства</p>

                <h3>Репозиторий</h3>
                <p><a href="https://github.com/Dan9191/mos" target="_blank">https://github.com/Dan9191/mos</a></p>

                <h3>Образ</h3>
                <p>Последний образ доступен на странице <a href="https://github.com/Dan9191/mos/pkgs/container/mos" target="_blank">https://github.com/Dan9191/mos/pkgs/container/mos</a></p>

                <h3>Swagger</h3>
                <p>Доступен по</p>
                <p><a href="https://api.mos-hack.ru/api/swagger-ui/index.html" target="_blank">https://api.mos-hack.ru/api/swagger-ui/index.html</a></p>

                <h3>Стэк</h3>
                <p>Требуется Java 21 и Gradle.</p>

                <h4>Сборка</h4>
                <pre><code>./gradlew clean build</code></pre>

                <h4>Запуск</h4>
                <pre><code>./gradlew bootRun</code></pre>

                <h3>Конфигурация</h3>
                <p>Настройки в <code>src/main/resources/application.yaml</code>:</p>
                <table>
                    <thead>
                    <tr>
                        <th>Переменная</th>
                        <th>Значение по умолчанию</th>
                        <th>Описание</th>
                    </tr>
                    </thead>
                    <tbody>
                    <tr>
                        <td>SERVER_PORT</td>
                        <td>8091</td>
                        <td>Порт сервиса</td>
                    </tr>
                    <tr>
                        <td>SPRING_APPLICATION_NAME</td>
                        <td>mos</td>
                        <td>Имя приложения</td>
                    </tr>
                    <tr>
                        <td>SPRING_DATASOURCE_URL</td>
                        <td>jdbc:postgresql://localhost:5432/test?currentSchema=mos</td>
                        <td>URL базы данных PostgreSQL</td>
                    </tr>
                    <tr>
                        <td>DATASOURCE_NAME</td>
                        <td>test</td>
                        <td>Пользователь базы данных</td>
                    </tr>
                    <tr>
                        <td>DATASOURCE_PASSWORD</td>
                        <td>test</td>
                        <td>Пароль базы данных</td>
                    </tr>
                    <tr>
                        <td>KEYCLOAK</td>
                        <td>http://localhost:9090/realms/hackathon</td>
                        <td>Ссылка на сервис аутентификации</td>
                    </tr>
                    <tr>
                        <td>UPLOAD_BASE_URL</td>
                        <td>http://localhost:8091/api/files</td>
                        <td>Шаблон для формирования ссылки на документы</td>
                    </tr>
                    </tbody>
                </table>

                <h3>Ресурсы kubernetes</h3>

                <h4>Argo cd</h4>
                <pre><code>
apiVersion: argoproj.io/v1alpha1
kind: Application
metadata:
  name: mos-backend
  namespace: argocd
spec:
  project: default
  source:
    repoURL: *********
    targetRevision: main
    path: apps/mos/backend/
  destination:
    server: https://kubernetes.default.svc
    namespace: mos-backend
  syncPolicy:
    automated:
      prune: true
      selfHeal: true
    syncOptions:
      - CreateNamespace=true</code></pre>

                <h4>Ingres</h4>
                <pre><code>apiVersion: networking.k8s.io/v1
kind: Ingress
metadata:
  name: mos-backend
  namespace: mos-backend
  annotations:
    nginx.ingress.kubernetes.io/ssl-redirect: "true"
    nginx.ingress.kubernetes.io/force-ssl-redirect: "true"
spec:
  ingressClassName: nginx
  tls:
    - hosts:
        - api.mos-hack.ru
      secretName: mos-backend-tls
  rules:
    - host: api.mos-hack.ru
      http:
        paths:
          - path: /api
            pathType: Prefix
            backend:
              service:
                name: mos-backend
                port:
                  number: 8091</code></pre>

                <h4>Kustomization</h4>
                <pre><code>
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
namespace: mos-backend
resources:
  - mos-configmap.yaml
  - mos-deployment.yaml
  - mos-service.yaml
  - secret.yaml
  - ingress.yaml
  - servicemonitor.yaml</code></pre>

                <h4>ConfigMap</h4>
                <pre><code>
apiVersion: v1
kind: ConfigMap
metadata:
  name: mos-backend-config
  namespace: mos-backend
data:
  SERVER_PORT: "8091"
  SPRING_APPLICATION_NAME: "mos-backend"
  DATASOURCE_URL: "jdbc:postgresql://postgres.postgres.svc.cluster.local:5432/postgres?currentSchema=mos"
  KEYCLOAK: "https://auth.mos-hack.ru/realms/hackathon"
  UPLOAD_BASE_URL: "https://api.mos-hack.ru/api/files"
  KEYCLOAK_URL: "https://auth.mos-hack.ru"
  KEYCLOAK_REALM: "hackathon"
  KEYCLOAK_ADMIN_CLIENT: "hackathon-backend"</code></pre>

                <h4>Deployment</h4>
                <pre><code>
apiVersion: apps/v1
kind: Deployment
metadata:
  name: mos-backend
  namespace: mos-backend
spec:
  replicas: 1
  selector:
    matchLabels:
      app: mos-backend
  template:
    metadata:
      labels:
        app: mos-backend
      annotations:
        prometheus.io/scrape: "true"
        prometheus.io/port: "8091"
        prometheus.io/path: "/actuator/prometheus"
    spec:
      containers:
        - name: mos-backend
          image: ghcr.io/dan9191/mos:sha-92cd99c3ccf671ac1d2a9134a3b588678864110c
          ports:
            - containerPort: 8091
          envFrom:
            - configMapRef:
                name: mos-backend-config
            - secretRef:
                name: mos-backend-db-secret
          env:
            - name: DATASOURCE_PASSWORD
              valueFrom:
                secretKeyRef:
                  name: mos-backend-db-secret
                  key: DATASOURCE_PASSWORD
            - name: DATASOURCE_NAME
              valueFrom:
                secretKeyRef:
                  name: mos-backend-db-secret
                  key: DATASOURCE_NAME
            - name: KEYCLOAK_ADMIN_SECRET
              valueFrom:
                secretKeyRef:
                  name: mos-backend-db-secret
                  key: KEYCLOAK_ADMIN_SECRET
          resources:
            requests:
              cpu: "500m"
              memory: "500Mi"
            limits:
              cpu: "1"
              memory: "500Mi"</code></pre>

                <h4>Service</h4>
                <pre><code>apiVersion: v1
kind: Service
metadata:
  name: mos-backend
  namespace: mos-backend
  labels:
    prometheus.io/scrape: "true"
    prometheus.io/port: "8091"
spec:
  type: ClusterIP
  selector:
    app: mos-backend
  ports:
    - name: http
      port: 8091
      targetPort: 8091</code></pre>

                <h4>Secret</h4>
                <pre><code>
apiVersion: v1
kind: Secret
metadata:
  name: mos-backend-db-secret
  namespace: mos-backend
type: Opaque
stringData:
  DATASOURCE_NAME: "********"
  DATASOURCE_PASSWORD: "********"
  KEYCLOAK_ADMIN_SECRET: "********"</code></pre>

                <h4>ServiceMonitor</h4>
                <pre><code>
apiVersion: monitoring.coreos.com/v1
kind: ServiceMonitor
metadata:
  name: mos-backend-sm
  namespace: observability
  labels:
    release: prometheus
spec:
  selector:
    matchLabels:
      app: mos-backend
  endpoints:
    - port: http
      path: /actuator/prometheus
      interval: 30s
      scrapeTimeout: 5s
      honorLabels: true
  namespaceSelector:
    matchNames:
      - mos-backend</code></pre>
            </div>
        </div>

        <div class="content-footer">
            <p>Документация обновлена 11.01.2026</p>
        </div>
    </main>
</div>

<script src="script.js"></script>
</body>
</html>